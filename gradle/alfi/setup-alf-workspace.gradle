task setupAlfWorkspace {
    group 'alfi-samples'

    def targetDirectory = "$buildDir/alf-workspace"

    doLast {
        file(targetDirectory).deleteDir()
        file(targetDirectory).mkdir()

        copy {
            from file("$projectDir/alf-lib")
            into file("$targetDirectory")
        }

        def jarWithAlfFiles = file("$buildDir/artifacts/mps-alfi-samples/mps-alfi-samples/languages/mps-alfi-samples/HamsterSimulatorLanguage.sandbox-src.jar")
        copy {
            from(zipTree(jarWithAlfFiles)){
                include 'HamsterSimulatorLanguage/sandbox/**/*.alf'
            }
            into file("$targetDirectory")
            eachFile { FileCopyDetails details ->
                details.path = details.path.replaceFirst('HamsterSimulatorLanguage/sandbox/', '')
            }
            includeEmptyDirs = false

            // workaround: test suite generation has to be adjusted, until so, we add a manual activity for this
            file("$targetDirectory/HamsterTestSuiteActivity.alf").text = """
            activity HamsterTestSuiteActivity() {
                new HamsterTestSuite().HelloPaule();
                new HamsterTestSuite().Demo();
                WriteLine("FINISHED");
            }
            """
        }
    }
}